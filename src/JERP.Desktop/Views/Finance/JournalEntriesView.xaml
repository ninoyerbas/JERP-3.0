<!--
    JERP 3.0 - Payroll & ERP System
    Copyright (c) 2026 ninoyerbas. All Rights Reserved.
    
    PROPRIETARY AND CONFIDENTIAL
    
    This source code is the confidential and proprietary information of ninoyerbas.
    Unauthorized copying, modification, distribution, or use is strictly prohibited.
    
    For licensing inquiries: licensing@jerp.io
-->

<UserControl x:Class="JERP.Desktop.Views.Finance.JournalEntriesView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:ui="http://schemas.modernwpf.com/2019">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBox Grid.Column="0" Text="{Binding SearchQuery, UpdateSourceTrigger=PropertyChanged}" 
                     ui:ControlHelper.PlaceholderText="Search journal entries..." 
                     Height="35" FontSize="14" VerticalContentAlignment="Center" Margin="0,0,10,0">
                <TextBox.InputBindings>
                    <KeyBinding Key="Enter" Command="{Binding PerformSearchCommand}"/>
                </TextBox.InputBindings>
            </TextBox>

            <ComboBox Grid.Column="1" SelectedItem="{Binding SelectedStatusFilter}" 
                      ItemsSource="{Binding StatusFilterOptions}"
                      Height="35" FontSize="14" VerticalContentAlignment="Center" Margin="0,0,10,0"
                      ui:ControlHelper.PlaceholderText="Filter by Status"/>

            <StackPanel Grid.Column="2" Orientation="Horizontal">
                <Button Content="New Entry" Command="{Binding CreateNewEntryCommand}" 
                        Height="35" MinWidth="110" Margin="0,0,10,0" Style="{StaticResource AccentButtonStyle}"/>
                <Button Content="Refresh" Command="{Binding RefreshDataCommand}" 
                        Height="35" MinWidth="80"/>
            </StackPanel>
        </Grid>

        <DataGrid Grid.Row="1" ItemsSource="{Binding JournalEntriesList}" 
                  SelectedItem="{Binding CurrentSelectedEntry}"
                  AutoGenerateColumns="False" 
                  CanUserAddRows="False" CanUserDeleteRows="False"
                  IsReadOnly="True">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Journal Entry #" Binding="{Binding JournalEntryNumber}" Width="150"/>
                <DataGridTextColumn Header="Transaction Date" Binding="{Binding TransactionDate, StringFormat=d}" Width="140"/>
                <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="250"/>
                <DataGridTextColumn Header="Total Debit" Binding="{Binding TotalDebit, StringFormat=C}" Width="130"/>
                <DataGridTextColumn Header="Total Credit" Binding="{Binding TotalCredit, StringFormat=C}" Width="130"/>
                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                <DataGridTemplateColumn Header="Actions" Width="250">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <Button Content="View" Command="{Binding DataContext.ViewEntryDetailsCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}" 
                                        CommandParameter="{Binding}" Margin="0,0,5,0" Padding="10,5"/>
                                <Button Content="Post" Command="{Binding DataContext.PostEntryCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}" 
                                        CommandParameter="{Binding}" Margin="0,0,5,0" Padding="10,5"/>
                                <Button Content="Void" Command="{Binding DataContext.VoidEntryCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}" 
                                        CommandParameter="{Binding}" Padding="10,5"/>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,15,0,0">
            <Button Content="Previous" Command="{Binding NavigatePreviousCommand}" 
                    Height="35" MinWidth="100" Margin="0,0,10,0"
                    IsEnabled="{Binding CanNavigatePrevious}"/>
            <TextBlock VerticalAlignment="Center" Margin="10,0" FontSize="14">
                <Run Text="Page"/>
                <Run Text="{Binding ActivePageNumber, Mode=OneWay}"/>
                <Run Text="of"/>
                <Run Text="{Binding TotalPageCount, Mode=OneWay}"/>
            </TextBlock>
            <Button Content="Next" Command="{Binding NavigateNextCommand}" 
                    Height="35" MinWidth="100" Margin="10,0,0,0"
                    IsEnabled="{Binding CanNavigateNext}"/>
        </StackPanel>
    </Grid>
</UserControl>
